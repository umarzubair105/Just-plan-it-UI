<div class="container-fluid px-4">
  <div class="col-md-8 offset-md-2 mb-2 mt-2">

    <div class="card">
      <div class="card-header bg-primary text-white">
        <h4 class="mb-0"><i class="bi bi-folder2-open me-2"></i> {{ messageChange('Products') }}</h4>
      </div>
      <div class="card-body bg-white col-md-12">
        <div class="text-end mb-2">
          <button (click)="addNewModel()"
                  class="btn btn-sm me-2"
                  title="Add new resource">
            <i class="bi bi-plus"></i> Add New {{ messageChange('Product') }}
          </button>
        </div>
        <div class="col-md-12 table-responsive">

          <ngx-datatable
            [columnMode]="'force'"
            [footerHeight]="30"
            [headerHeight]="40"
            [rowHeight]="'auto'"
            [rows]="models"
            class="bootstrap-table table-striped table-bordered table-hover">
            <ngx-datatable-column [maxWidth]="80" name="Code" prop="code"></ngx-datatable-column>
            <ngx-datatable-column name="Name" prop="name"></ngx-datatable-column>
            <ngx-datatable-column [maxWidth]="180" name="Non Productive Time %"
                                  prop="otherActivitiesPercentTime"></ngx-datatable-column>
            <ngx-datatable-column [maxWidth]="150" name="Release Duration">
              <ng-template let-row="row" ngx-datatable-cell-template>
                {{ row.releaseIteration.toString() | prettyLabel }}
              </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column [maxWidth]="150" name="First Working Date">
              <ng-template let-row="row" ngx-datatable-cell-template>
                {{ row.startDate }}
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column [maxWidth]="150" name="Last Delivery Date">
              <ng-template let-row="row" ngx-datatable-cell-template>
                {{ row.endDate | decimalToTime }}
              </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-column [maxWidth]="80" name="Action" [headerClass]="'text-center'">
              <ng-template let-row="row" ngx-datatable-cell-template>
                <div style="text-align: center;">
                <a (click)="openModalEdit(editModel,row.id)" title="Edit">
                  <i class="bi bi-pencil-square"></i>
                </a>
                </div>
              </ng-template>
            </ngx-datatable-column>
          </ngx-datatable>

        </div>
      </div>
    </div>
  </div>

  <ng-template #editModel>
    <div class="modal fade show d-block">
      <div class="modal-dialog">
        <div class="modal-content">

          <div class="modal-header text-white justify-content-between align-items-center py-2 px-3 ">
            <h5 class="modal-title mb-0 fx-6">Update {{ messageChange('Product') }}</h5>
            <button class="btn btn-sm text-white p-0" (click)="closeModal()">
              <i class="bi bi-x-lg"></i>
            </button>
          </div>
          <div class="modal-body">
            <form #resourceForm="ngForm">
              <div class="mb-2">
                <label class="form-label" for="nameR">Name <span class="text-danger">*</span></label>
                <input #name="ngModel" [(ngModel)]="model.name"
                       [ngClass]="{ 'is-invalid': name.invalid && (name.dirty || name.touched) }"
                       [showErrors]="{ required: 'Name is required' }" class="form-control"
                       id="nameR"
                       name="name" placeholder="Name"
                       required
                       type="text"/>
              </div>

              <div class="mb-2">
                <label class="form-label" for="codeR">Code <span class="text-danger">*</span></label>
                <input #code="ngModel" [(ngModel)]="model.code"
                       [ngClass]="{ 'is-invalid': code.invalid && (code.dirty || code.touched) }"
                       [showErrors]="{ required: 'Code is required' }" class="form-control"
                       id="codeR" name="code"
                       placeholder="Code" readonly
                       required
                       type="text"/>
              </div>

              <div class="mb-2">
                <label class="form-label" for="productManagerId">{{ messageChange('Product') }} Manager <span
                  class="text-danger">*</span></label>
                <select #productManagerId="ngModel" [(ngModel)]="model.productManagerId"
                        [ngClass]="{ 'is-invalid': productManagerId.invalid && (productManagerId.dirty || productManagerId.touched) }"
                        [showErrors]="{ required: 'Designation is required' }" class="form-control"
                        id="productManagerId"
                        name="productManagerId"
                        required>
                  <option *ngFor="let res of resources" [value]="res.id">
                    {{ res.name }}
                  </option>
                </select>

              </div>

              <div class="mb-2">
                <label class="form-label" for="otherActivitiesPercentTime">Non Productive Time % <span
                  class="text-danger">*</span></label>
                <input #otherActivitiesPercentTime="ngModel" [(ngModel)]="model.otherActivitiesPercentTime"
                       [ngClass]="{ 'is-invalid': otherActivitiesPercentTime.invalid && (otherActivitiesPercentTime.dirty || otherActivitiesPercentTime.touched) }"
                       [showErrors]="{ required: 'Non productive time is required', min:'Min value is 0',
                             max:'Max value is 100', pattern: 'Should be number only'}" class="form-control"
                       id="otherActivitiesPercentTime"
                       max="100"
                       min="0"
                       name="otherActivitiesPercentTime"
                       placeholder="Non Productive Time %" required
                       required
                       type="text"/>
              </div>


              <div class="mb-2">
                <label class="form-label" for="releaseIteration">Release Duration <span
                  class="text-danger">*</span></label>
                <select #releaseIteration="ngModel" [(ngModel)]="model.releaseIteration"
                        [ngClass]="{ 'is-invalid': releaseIteration.invalid && (releaseIteration.dirty || releaseIteration.touched) }"
                        [showErrors]="{ required: 'Designation is required' }" class="form-control"
                        id="releaseIteration"
                        name="releaseIteration"
                        required>
                  <option *ngFor="let releaseIteration of releaseIterations" [value]="releaseIteration.viewValue">
                    {{ releaseIteration.value }}
                  </option>
                </select>

              </div>
              <div class="mb-2">
                <label class="form-label" for="startDate">First Working Date</label>
                <input
                  [min]="model.startDate"
                  #startDate="ngModel"
                  [(ngModel)]="model.startDate"
                  [ngClass]="{ 'is-invalid': startDate.invalid && (startDate.dirty || startDate.touched) }"
                  [showErrors]="{ required: 'First working date is required' }"
                  class="form-control"
                  id="startDate"
                  name="startDate" placeholder="First Working Date"

                  required

                  type="date"
                />
              </div>

              <div class="mb-2">
                <label class="form-label" for="endDate">Last Delivery Date</label>
                <input
                  [min]="model.startDate?model.startDate:getToDayDate()"
                  #endDate="ngModel"
                  [(ngModel)]="model.endDate"
                  [ngClass]="{ 'is-invalid': endDate.invalid && (endDate.dirty || endDate.touched) }"
                  [showErrors]="{ required: 'Last delivery date is required' }"
                  class="form-control"
                  id="endDate" name="endDate"

                  placeholder="Last Delivery Date"

                  type="date"
                />
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button (click)="update()" [disabled]="resourceForm.invalid" class="btn btn-primary w-20">Save</button>
            <button (click)="closeModal()" class="btn btn-secondary w-20">Close</button>
          </div>
        </div>
      </div>
    </div>
  </ng-template>
</div>


<!--
 Multi Resources Adddition
  <div class="card shadow-lg">
    <div class="card-header bg-primary text-white text-center">
      <h3>Add Multiple Resources</h3>
    </div>
    <form [formGroup]="myForm" (ngSubmit)="onSubmit()">
    <div class="card-body">
      <div class="mb-3">
        <label for="email" class="form-label">Emails</label>
        <textarea
          type="text"
          id="email"
          class="form-control"
          formControlName="email"
          placeholder="Enter your email"
          [showErrors]="{ required: 'Email is required', email: 'Email is not valid' }"
        ></textarea>
      </div>
      <div class="mt-3">
        <label for="roleId" class="form-label">Role</label>
        <select
          id="roleId"
          class="form-select"
          formControlName="roleId"
          [showErrors]="{ required: 'Role is required' }"
        >
          <option value="" disabled selected>Select a role</option>
          <option *ngFor="let m of roles" [value]="m.id">
            {{ m.name }}
          </option>
        </select>

      </div>

      <div class="text-center">
        <button class="btn btn-primary" type="submit">Submit</button>
        <button type="reset" class="btn btn-secondary" >Reset</button>
      </div>
    </div>
    </form>
  </div>-->
